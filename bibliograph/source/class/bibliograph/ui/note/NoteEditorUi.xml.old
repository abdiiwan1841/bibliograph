<?xml version="1.0" encoding="utf-8"?>
<qxt:component
  xmlns:qx="http://www.qxtransformer.org/qooxdoo/0.8"
  xmlns:qxt="http://www.qxtransformer.org/extension/0.4"
  xmlns:qcl="http://www.qooxdoo.org/contrib/qcl/trunk"
  xmlns:itemView="bibliograph.ui.item.*"
  author="Christian Boulanger"
  className="bibliograph.ui.item.NoteEditorUi"
  extend="bibliograph.ui.item.NoteEditor"
  tagName="noteEditor">
  
  <qx:composite>
    <qx:grow>

      <!-- html view -->
      <qx:embedHtml
        padding="3"
        id="view" qxt:scope="this"
        overflowY="scroll"
        visibility="visible"
        html="">         
        <qxt:listener type="dblclick" delegate="_on_dblclick"/>
      </qx:embedHtml>   
      
      <!-- html editor -->
      <itemView:htmlEditor
        id="editor" qxt:scope="this"
        visibility="excluded"
        saveFunction="{js}qx.lang.Function.bind( this._on_save, this )"
        exitFunction="{js}qx.lang.Function.bind( this._on_exit, this )" />
   
      <!-- store providing data -->
      <qcl:jsonRpcStore 
        id="store" qxt:scope="this"
        serviceName="bibliograph.controller.Note">
        <qxt:bind 
          propertyChain="model.text"
          target="this.view" 
          targetPropertyChain="html" />
        <qxt:bind 
          propertyChain="model.text"
          target="this.editor" 
          targetPropertyChain="value" />                                
        <qxt:bind 
          propertyChain="model.title"
          target="this.getApplication().getWidgetById('itemViewTitleLabel')" 
          targetPropertyChain="value"/>
        <qxt:bind 
          propertyChain="model.childNoteData"
          target="this" 
          targetPropertyChain="childNoteData" />          
      </qcl:jsonRpcStore>

    </qx:grow>
  </qx:composite>
  
</qxt:component>